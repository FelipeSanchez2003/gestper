@model Gestper.Models.Bitacora
@{
    Layout = null;
    var trabajadores = ViewBag.Trabajadores as List<SelectListItem> ?? new List<SelectListItem>();
    string rol = Context.Session.GetString("UsuarioRol");
}

<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8" />
    <title>Detalle Bitácora</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet" />
    <style>
        body { margin: 0; font-family: 'Roboto', Arial, sans-serif; background-color: #f5f5f5; }
        .container { display: flex; min-height: 100vh; }
        .sidebar { width: 250px; background-color: #0074e8; display: flex; justify-content: center; align-items: center; }
        .logo { height: 140px; }
        .content { flex-grow: 1; padding: 40px; display: flex; justify-content: center; }
        .detail-card { background: white; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); padding: 30px; width: 700px; display: flex; }
        .left-info { width: 40%; padding-right: 30px; background-color: #f0f4ff; border-radius: 8px; padding: 20px; }
        .left-info label { font-weight: 500; display: block; margin-bottom: 5px; margin-top: 15px; }
        .right-form { width: 60%; padding-left: 20px; }
        .right-form h2 { color: #0074e8; margin-bottom: 20px; }
        textarea, input, select { width: 100%; padding: 10px; border-radius: 4px; border: 1px solid #ccc; margin-bottom: 20px; resize: none; }
        .btn { padding: 10px 20px; border: none; border-radius: 4px; font-weight: 500; cursor: pointer; }
        .btn-primary { background-color: #007bff; color: white; }
        .btn-secondary { background-color: #6c757d; color: white; margin-right: 10px; }
    </style>
</head>
<body>

<div class="container">
    <div class="sidebar">
        <img src="/images/logo.png" alt="Logo Gestper" class="logo" />
    </div>

    <div class="content">
        <div class="detail-card">
            <div class="left-info">
                <a href="@Url.Action("Bitacora", "HomeControllerAdmin")">← Volver</a>

                <label>ID de Bitácora</label>
                <div>@Model.Id</div>

                <label>Creado por</label>
                <div>@Model.Usuario?.Nombre @Model.Usuario?.Apellido</div>

                <label>Correo</label>
                <div>@Model.Usuario?.Correo</div>

                <label>Teléfono</label>
                <div>@Model.Usuario?.Telefono</div>

                <label>Fecha de creación</label>
                <div>@Model.FechaCreacion.ToString("dd-MM-yyyy")</div>
            </div>

            <div class="right-form">
                <h2>Editar Bitácora</h2>

                <form asp-action="GuardarDetalleBitacora" method="post">
                    <input type="hidden" name="Id" value="@Model.Id" />

                    <label>Descripción</label>
                    <textarea name="Descripcion" rows="8">@Model.Descripcion</textarea>

                    @if (rol == "1")
                    {
                        <label>Asignado a</label>
                        <select name="IdSoporteAsignado">
                            <option value="">Sin asignar</option>
                            @foreach (var trabajador in trabajadores)
                            {
                                <option value="@trabajador.Value" selected="@(Model.IdSoporteAsignado == int.Parse(trabajador.Value) ? "selected" : null)">
                                    @trabajador.Text
                                </option>
                            }
                        </select>
                    }

                    <label>Prioridad</label>
                    <select name="Prioridad">
                        @{
                            var prioridades = new[] { "Baja", "Media", "Alta" };
                        }
                        @foreach (var prioridad in prioridades)
                        {
                            <option value="@prioridad" selected="@(Model.Prioridad == prioridad ? "selected" : null)">
                                @prioridad
                            </option>
                        }
                    </select>

                    <label>Estado</label>
                    <select name="Estado">
                        @{
                            var estados = new[] { "Abierto", "En Proceso", "Resuelto", "Cerrado" };
                        }
                        @foreach (var estado in estados)
                        {
                            <option value="@estado" selected="@(Model.Estado == estado ? "selected" : null)">
                                @estado
                            </option>
                        }
                    </select>

                    <div>
                        <button type="submit" class="btn btn-primary">Guardar</button>
                        <a href="@Url.Action("Bitacora", "HomeControllerAdmin")" class="btn btn-secondary">Cancelar</a>
                    </div>
                </form>

            </div>
        </div>
    </div>
</div>

</body>
</html>